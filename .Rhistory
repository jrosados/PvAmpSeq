knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
tidy = TRUE,
fig.width = 8,
fig.height = 6)
library(tidyverse)
library(RColorBrewer)
library(ggpubr)
library(cowplot)
library(ggh4x)
library(table1)
library(tableone)
load("./intermediate_data/intermediate_data.RData")
load("./intermediate_data/intermediate_data.RData")
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
tidy = TRUE,
fig.width = 8,
fig.height = 6)
library(tidyverse)
library(here)
library(RColorBrewer)
library(ggpubr)
library(cowplot)
library(ggh4x)
library(table1)
library(tableone)
#####################
#SOLOMON ISLANDS    #
#####################
### SELECTING SAMPLE HAPLOTYPES WITH >1% FREQUENCY AND PRESENT IN AT LEAST >=2 SAMPLES
Filter_hap_SI <- readRDS(here("raw_data","SI_seq_tbl_End_Filter.rds")) %>%
filter(Frequency >= 0.01)
Exclude_singleton_SI<- Filter_hap_SI%>%
dplyr::group_by(Haplotype) %>%
dplyr::summarise(n = dplyr::n(), .groups = "drop") %>%
dplyr::filter(n > 1L)
Filter_hap_SI <- Filter_hap_SI %>%
filter(Haplotype %in% Exclude_singleton_SI$Haplotype)
AmpSeq_samples_data_SI <- read.delim(here("raw_data","sample_table_SI_301220.txt"), header = TRUE, sep = "\t")
Epi_data_SI<- read.csv(here("raw_data","SI_Master_epi_data.csv"), header = T)
# Merging the AmpSeq run information (copies/uL and Cq) with SI Epi data
hap_SI_epi<-
Filter_hap_SI %>%
left_join(AmpSeq_samples_data_SI, by = c("sample" = "SampleID"))%>%
mutate(SampleName = as.integer(SampleName),
infoD = as.integer(infoD)) %>%
left_join(Epi_data_SI, by = c("SampleName" = "studyid", "infoD" = "vis_visit_day"))
#########################
# PERUVIAN COHORT       #
#########################
### SELECTING SAMPLE HAPLOTYPES WITH >1% FREQUENCY AND PRESENT IN AT LEAST >=2 SAMPLES
Filter_hap_PE <- readRDS(here("raw_data", "PE_seq_flt_tbl.rds")) %>%
filter(frequency >= 0.01)
Exclude_singleton_PE<- Filter_hap_PE%>%
dplyr::group_by(haplotype) %>%
dplyr::summarise(n = dplyr::n(), .groups = "drop") %>%
dplyr::filter(n > 1L)
Filter_hap_PE <- Filter_hap_PE %>%
filter(haplotype %in% Exclude_singleton_PE$haplotype)
AmpSeq_samples_data_PE <- read.csv(here("raw_data","PE_Sample_sheet.csv"), header = TRUE)
Epi_data_PE<- read.csv(here("raw_data", "PE_23_05_18_Clinic_data-3y.csv"), header = T)
#Merging the AmpSeq run information (copies/uL and Cq) with PE Epi data
hap_PE_epi<-
Filter_hap_PE %>%
left_join(AmpSeq_samples_data_PE, by = c("sample_id" = "SampleID")) %>%
left_join(Epi_data_PE, by = c("sample_id" = "cod_samp", "PatientName" = "cod_per"))
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
tidy = TRUE,
fig.width = 8,
fig.height = 6)
library(tidyverse)
library(RColorBrewer)
library(ggpubr)
library(cowplot)
library(ggh4x)
library(table1)
library(tableone)
library(RColorBrewer)
library(forcats)
load("./intermediate_data/intermediate_data.RData")
